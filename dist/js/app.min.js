/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function s(e){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?r(Object(a),!0).forEach((function(r){t(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var a={"#":{pattern:/[0-9]/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},A:{pattern:/[a-zA-Z]/,uppercase:!0},a:{pattern:/[a-zA-Z]/,lowercase:!0},"!":{escape:!0},"*":{repeat:!0}};function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return i(t).length>1?o(t)(e,t,r,s):l(e,t,r,s)}function i(e){try{return JSON.parse(e)}catch(t){return[e]}}function o(e){var t=i(e).sort((function(e,t){return e.length-t.length}));return function(e,s,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.map((function(t){return l(e,t,a,!1)})),o=i.pop();for(var c in t)if(r(o,t[c],a))return l(e,t[c],a,n);return""};function r(e,t,r){for(var s in r)r[s].escape&&(t=t.replace(new RegExp(s+".{1}","g"),""));return t.split("").filter((function(e){return r[e]&&r[e].pattern})).length>=e.length}}function l(e,t,r){for(var s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=0,n=0,i="",o="";a<t.length&&n<e.length;){var l=t[a],u=e[n],d=r[l];if(d&&d.pattern)d.pattern.test(u)&&(i+=c(u,d),a++,s&&t[a]&&(r[t[a]]?r[t[a]]&&r[t[a]].escape&&(i+=t[a+1],a+=2):(i+=t[a],a++))),n++;else if(d&&d.repeat){var p=r[t[a-1]];p&&!p.pattern.test(u)?a++:a--}else d&&d.escape&&(l=t[++a]),s&&(i+=l),u===l&&n++,a++}for(;s&&a<t.length;){var v=t[a];if(r[v]){o="";break}o+=v,a++}return i+o}function c(e,t){return t.transform&&(e=t.transform(e)),t.uppercase?e.toLocaleUpperCase():t.lowercase?e.toLocaleLowerCase():e}function u(e){return e instanceof HTMLInputElement?e:e.querySelector("input")||e}function d(e){return"[object String]"===Object.prototype.toString.call(e)}var p,v=function(){function t(r){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e(this,t),!r)throw new Error("Maska: no element for mask");if(null!=i.preprocessor&&"function"!=typeof i.preprocessor)throw new Error("Maska: preprocessor must be a function");if(i.tokens)for(var o in i.tokens)i.tokens[o]=s({},i.tokens[o]),i.tokens[o].pattern&&d(i.tokens[o].pattern)&&(i.tokens[o].pattern=new RegExp(i.tokens[o].pattern));this._opts={mask:i.mask,tokens:s(s({},a),i.tokens),preprocessor:i.preprocessor},this._el=d(r)?document.querySelectorAll(r):r.length?r:[r],this.inputEvent=function(e){return n.updateValue(e.target,e)},this.init()}var r;return(r=[{key:"init",value:function(){for(var e=this,t=function(t){var r=u(e._el[t]);!e._opts.mask||r.dataset.mask&&r.dataset.mask===e._opts.mask||(r.dataset.mask=e._opts.mask),setTimeout((function(){return e.updateValue(r)}),0),r.dataset.maskInited||(r.dataset.maskInited=!0,r.addEventListener("input",e.inputEvent),r.addEventListener("beforeinput",e.beforeInput))},r=0;r<this._el.length;r++)t(r)}},{key:"destroy",value:function(){for(var e=0;e<this._el.length;e++){var t=u(this._el[e]);t.removeEventListener("input",this.inputEvent),t.removeEventListener("beforeinput",this.beforeInput),delete t.dataset.mask,delete t.dataset.maskInited}}},{key:"updateValue",value:function(e,t){if(e&&e.type){var r=e.type.match(/^number$/i)&&e.validity.badInput;if(!e.value&&!r||!e.dataset.mask)return e.dataset.maskRawValue="",void this.dispatch("maska",e,t);var s=e.selectionEnd,a=e.value,i=a[s-1];e.dataset.maskRawValue=n(e.value,e.dataset.mask,this._opts.tokens,!1);var o=e.value;this._opts.preprocessor&&(o=this._opts.preprocessor(o)),e.value=n(o,e.dataset.mask,this._opts.tokens),t&&"insertText"===t.inputType&&s===a.length&&(s=e.value.length),function(e,t,r){for(;t&&t<e.value.length&&e.value.charAt(t-1)!==r;)t++;(e.type?e.type.match(/^(text|search|password|tel|url)$/i):!e.type)&&e===document.activeElement&&(e.setSelectionRange(t,t),setTimeout((function(){e.setSelectionRange(t,t)}),0))}(e,s,i),this.dispatch("maska",e,t),e.value!==a&&this.dispatch("input",e,t)}}},{key:"beforeInput",value:function(e){e&&e.target&&e.target.type&&e.target.type.match(/^number$/i)&&e.data&&isNaN(e.target.value+e.data)&&e.preventDefault()}},{key:"dispatch",value:function(e,t,r){t.dispatchEvent(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.createEvent("Event");return r.initEvent(e,!0,!0),t&&(r.inputType=t),r}(e,r&&r.inputType||null))}}])&&function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(t.prototype,r),t}(),m=(p=new WeakMap,function(e,t){t.value&&(p.has(e)&&!function(e){return!(d(e.value)&&e.value===e.oldValue||Array.isArray(e.value)&&JSON.stringify(e.value)===JSON.stringify(e.oldValue)||e.value&&e.value.mask&&e.oldValue&&e.oldValue.mask&&e.value.mask===e.oldValue.mask)}(t)||p.set(e,new v(e,function(e){var t={};return e.mask?(t.mask=Array.isArray(e.mask)?JSON.stringify(e.mask):e.mask,t.tokens=e.tokens?s({},e.tokens):{},t.preprocessor=e.preprocessor):t.mask=Array.isArray(e)?JSON.stringify(e):e,t}(t.value))))});"undefined"!=typeof window&&window.Vue&&window.Vue.use&&window.Vue.use((function(e){e.directive("maska",m)}));const f=document.getElementById("name"),y=document.getElementById("date"),h=document.getElementById("email"),b=document.getElementById("phone"),g=document.getElementById("submit-btn"),L=document.querySelectorAll(".form__input-wrapper"),k=document.getElementsByTagName("input"),w=document.getElementById("success-popup"),E=document.getElementById("error-popup");function O(){let e=0;L.forEach((t=>{t.classList.contains("has-success")&&e++})),g.disabled=4!==e}function A(){document.body.classList.remove("lock"),document.body.style.top="",window.scrollTo(0,document.body.dataset.scroll),document.body.removeAttribute("data-scroll")}function S(e,t,r,s){return Number(e)<=31&&Number(t)<=12&&Number(r)>=1900&&Number(r)<2015&&10===s.length}function _(e){return!!(e.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)&&e.length<50&&"yandex.com"!==e.split("@")[1]&&"yandex.co"!==e.split("@")[1]&&"gmail.ru"!==e.split("@")[1]&&"gmail.co"!==e.split("@")[1]&&"mail.co"!==e.split("@")[1]&&"mail.com"!==e.split("@")[1])}function I(e){return!!(e.match(/^[А-ЯЁA-Z][а-яёa-z]{0,}([-][А-ЯЁA-Z][а-яёa-z]{0,})?\s[А-ЯЁA-Z][а-яёa-z]{0,}([-][А-ЯЁA-Z][а-яёa-z]{0,})?/)&&e.length<50)}function j(e){return 18===e.length}let B=!0;new v(".masked",void 0),{Android:()=>navigator.userAgent.match(/Android/i),BlackBerry:()=>navigator.userAgent.match(/BlackBerry/i),IOS:()=>navigator.userAgent.match(/iPhone|iPad|iPod/i),Opera:()=>navigator.userAgent.match(/Opera Mini/i),Windows:()=>navigator.userAgent.match(/IEMobile/i),any:function(){return this.Android()||this.BlackBerry()||this.IOS()||this.Opera()||this.Windows()}}.any()?document.body.classList.add("mobile"):document.body.classList.add("desktop"),f.addEventListener("input",(e=>{const t=e.target,r=t.closest(".form__input-wrapper"),s=r.querySelector(".empty-error"),a=r.querySelector(".incomplete-error");return 0===t.value.length?(t.classList.add("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.add("empty-error-visible"),r.classList.remove("has-success"),void O()):I(t.value)?(r.classList.add("has-success"),t.classList.remove("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.remove("empty-error-visible"),void O()):(s.classList.remove("empty-error-visible"),a.classList.add("incomplete-error-visible"),t.classList.add("error-border"),r.classList.remove("has-success"),void O())})),y.addEventListener("input",(e=>{const t=e.target,r=t.closest(".form__input-wrapper"),s=r.querySelector(".empty-error"),a=r.querySelector(".incomplete-error"),n=t.value.split(".")[0],i=t.value.split(".")[1],o=t.value.split(".")[2];return 0===t.value.length?(t.classList.add("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.add("empty-error-visible"),r.classList.remove("has-success"),void O()):S(n,i,o,t.value)?(r.classList.add("has-success"),t.classList.remove("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.remove("empty-error-visible"),void O()):(s.classList.remove("empty-error-visible"),a.classList.add("incomplete-error-visible"),t.classList.add("error-border"),r.classList.remove("has-success"),void O())})),b.addEventListener("input",(e=>{const t=e.target,r=t.closest(".form__input-wrapper"),s=r.querySelector(".empty-error"),a=r.querySelector(".incomplete-error");return 0===t.value.length?(t.classList.add("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.add("empty-error-visible"),r.classList.remove("has-success"),O(),void(B=!0)):("+7 (8"===t.value&&B&&(t.value="+7 (",B=!1),j(t.value)?(r.classList.add("has-success"),t.classList.remove("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.remove("empty-error-visible"),void O()):(s.classList.remove("empty-error-visible"),a.classList.add("incomplete-error-visible"),t.classList.add("error-border"),r.classList.remove("has-success"),void O()))})),h.addEventListener("input",(e=>{const t=e.target,r=t.closest(".form__input-wrapper"),s=r.querySelector(".empty-error"),a=r.querySelector(".incomplete-error");return 0===t.value.length?(t.classList.add("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.add("empty-error-visible"),r.classList.remove("has-success"),void O()):_(t.value)?(r.classList.add("has-success"),t.classList.remove("error-border"),a.classList.remove("incomplete-error-visible"),s.classList.remove("empty-error-visible"),void O()):(s.classList.remove("empty-error-visible"),a.classList.add("incomplete-error-visible"),t.classList.add("error-border"),r.classList.remove("has-success"),void O())})),[w,E].forEach((e=>{e.addEventListener("click",(()=>{switch(A(),e.id){case"success-popup":w.classList.add("invisible");break;case"error-popup":E.classList.add("invisible")}}))})),document.getElementById("success-wrapper").addEventListener("click",(e=>{e.stopPropagation(),e.target.closest("#success-btn")&&(A(),w.classList.add("invisible"))})),document.getElementById("error-wrapper").addEventListener("click",(e=>{e.stopPropagation(),e.target.closest("#error-btn")&&(A(),E.classList.add("invisible"))})),Array.from(k).forEach((e=>{e.addEventListener("blur",(e=>{const t=e.target,r=t.closest(".form__input-wrapper").querySelector(".empty-error");0===t.value.length&&(t.classList.add("error-border"),r.classList.add("empty-error-visible"))}))})),g.addEventListener("click",(()=>{const e=y.value.split(".")[0],t=y.value.split(".")[1],r=y.value.split(".")[2],s=I(f.value),a=S(e,t,r,y.value),n=j(b.value),i=_(h.value);if(function(){const e=window.scrollY;document.body.dataset.scroll=e,document.body.classList.add("lock"),document.body.style.top=`-${e}px`}(),g.disabled=!0,g.innerHTML='Отправляется <span class="submit-spinner"></span>',!(s&&a&&n&&i))return document.querySelectorAll(".form__input-wrapper").forEach((e=>{e.classList.remove("has-success")})),g.innerHTML="Отправить заявку",void E.classList.remove("invisible");!async function(e,t){try{if(!(await fetch("https://second-approach-training-default-rtdb.europe-west1.firebasedatabase.app/users.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Server techical issues. Try again later.");w.classList.remove("invisible"),f.value="",y.value="",b.value="",h.value="",g.disabled=!0,L.forEach((e=>{e.classList.remove("has-success")}))}catch(e){E.classList.remove("invisible")}finally{g.innerHTML="Отправить заявку",O(),B=!0}}(0,{name:f.value,birthDate:y.value,phone:b.value,email:h.value})}))})();